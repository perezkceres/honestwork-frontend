"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=require("tslib"),e=require("@web3-react/abstract-connector");function t(n){return n.hasOwnProperty("result")?n.result:n}require("tiny-warning");var i=function(e){function t(){var n=e.call(this)||this;return n.name=n.constructor.name,n.message="No BSC provider was found on window.BinanceChain.",n}return n.__extends(t,e),t}(Error),a=function(e){function t(){var n=e.call(this)||this;return n.name=n.constructor.name,n.message="The user rejected the request.",n}return n.__extends(t,e),t}(Error);exports.BscConnector=function(e){function r(n){var t=e.call(this,n)||this;return t.handleNetworkChanged=t.handleNetworkChanged.bind(t),t.handleChainChanged=t.handleChainChanged.bind(t),t.handleAccountsChanged=t.handleAccountsChanged.bind(t),t.handleClose=t.handleClose.bind(t),t}return n.__extends(r,e),r.prototype.handleChainChanged=function(n){this.emitUpdate({chainId:n,provider:window.BinanceChain})},r.prototype.handleAccountsChanged=function(n){0===n.length?this.emitDeactivate():this.emitUpdate({account:n[0]})},r.prototype.handleClose=function(n,e){this.emitDeactivate()},r.prototype.handleNetworkChanged=function(n){this.emitUpdate({chainId:n,provider:window.BinanceChain})},r.prototype.activate=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(r){switch(r.label){case 0:if(!window.BinanceChain)throw new i;window.BinanceChain.on&&(window.BinanceChain.on("chainChanged",this.handleChainChanged),window.BinanceChain.on("accountsChanged",this.handleAccountsChanged),window.BinanceChain.on("close",this.handleClose),window.BinanceChain.on("networkChanged",this.handleNetworkChanged)),window.BinanceChain.isMetaMask&&(window.BinanceChain.autoRefreshOnNetworkChange=!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.BinanceChain.send("eth_requestAccounts").then((function(n){return t(n)[0]}))];case 2:return e=r.sent(),[3,4];case 3:if(4001===r.sent().code)throw new a;return[3,4];case 4:return e?[3,6]:[4,window.BinanceChain.enable().then((function(n){return n&&t(n)[0]}))];case 5:e=r.sent(),r.label=6;case 6:return[2,n.__assign({provider:window.BinanceChain},e?{account:e}:{})]}}))}))},r.prototype.getProvider=function(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){return[2,window.BinanceChain]}))}))},r.prototype.getChainId=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(n){switch(n.label){case 0:if(!window.BinanceChain)throw new i;n.label=1;case 1:return n.trys.push([1,3,,4]),[4,window.BinanceChain.send("eth_chainId").then(t)];case 2:return e=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:if(e)return[3,8];n.label=5;case 5:return n.trys.push([5,7,,8]),[4,window.BinanceChain.send("net_version").then(t)];case 6:return e=n.sent(),[3,8];case 7:return n.sent(),[3,8];case 8:if(!e)try{e=t(window.BinanceChain.send({method:"net_version"}))}catch(n){}return e||(e=window.BinanceChain.isDapper?t(window.BinanceChain.cachedResults.net_version):window.BinanceChain.chainId||window.BinanceChain.netVersion||window.BinanceChain.networkVersion||window.BinanceChain._chainId),[2,e]}}))}))},r.prototype.getAccount=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(n){switch(n.label){case 0:if(!window.BinanceChain)throw new i;n.label=1;case 1:return n.trys.push([1,3,,4]),[4,window.BinanceChain.send("eth_accounts").then((function(n){return t(n)[0]}))];case 2:return e=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:if(e)return[3,8];n.label=5;case 5:return n.trys.push([5,7,,8]),[4,window.BinanceChain.enable().then((function(n){return t(n)[0]}))];case 6:return e=n.sent(),[3,8];case 7:return n.sent(),[3,8];case 8:return e||(e=t(window.BinanceChain.send({method:"eth_accounts"}))[0]),[2,e]}}))}))},r.prototype.deactivate=function(){window.BinanceChain&&window.BinanceChain.removeListener&&(window.BinanceChain.removeListener("chainChanged",this.handleChainChanged),window.BinanceChain.removeListener("accountsChanged",this.handleAccountsChanged),window.BinanceChain.removeListener("close",this.handleClose),window.BinanceChain.removeListener("networkChanged",this.handleNetworkChanged))},r.prototype.isAuthorized=function(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:if(!window.BinanceChain)return[2,!1];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,window.BinanceChain.send("eth_accounts").then((function(n){return t(n).length>0}))];case 2:return[2,n.sent()];case 3:return n.sent(),[2,!1];case 4:return[2]}}))}))},r}(e.AbstractConnector),exports.NoBscProviderError=i,exports.UserRejectedRequestError=a;
//# sourceMappingURL=web3-connector.cjs.production.min.js.map
